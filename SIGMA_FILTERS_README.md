# Сигма-фильтры

## Описание

Реализованы сигма-фильтры для удаления шума и выбросов из изображений с различными значениями σ:

### Доступные фильтры
- **Сигма-фильтр σ=1.0**: Строгое удаление выбросов (отклонения > 1σ)
- **Сигма-фильтр σ=2.0**: Умеренное удаление выбросов (отклонения > 2σ)  
- **Сигма-фильтр σ=3.0**: Мягкое удаление выбросов (отклонения > 3σ)

## Математическая основа

### Алгоритм сигма-фильтрации
1. Для каждого пикселя извлекается окно размера NxN
2. Вычисляется среднее значение в окне: `mean = Σ(pixels) / N²`
3. Вычисляется стандартное отклонение: `std = √(Σ(pixel - mean)² / N²)`
4. Определяется порог отклонения: `threshold = σ * std`
5. Фильтруются пиксели: оставляются только те, где `|pixel - mean| ≤ threshold`
6. Результат = среднее отфильтрованных пикселей

### Формула порога
```
threshold = σ * standard_deviation
```

## Архитектура

### Базовый класс `SigmaFilter`
- Наследуется от `SmoothingFilter`
- Использует окно 5x5 для анализа
- Поддерживает различные значения σ
- Адаптивное удаление выбросов

### Специализированные классы
- `SigmaFilterSigma1`: σ=1.0, строгое удаление
- `SigmaFilterSigma2`: σ=2.0, умеренное удаление
- `SigmaFilterSigma3`: σ=3.0, мягкое удаление

## Особенности реализации

### Алгоритм обработки
1. **Извлечение окна**: Для каждого пикселя берется окно 5x5
2. **Статистический анализ**: Вычисление среднего и стандартного отклонения
3. **Фильтрация выбросов**: Удаление пикселей, отклоняющихся более чем на σ*std
4. **Усреднение**: Взвешенное среднее отфильтрованных пикселей

### Обработка краевых случаев
- **Все пиксели отклоняются**: Используется среднее всего окна
- **Нет отфильтрованных пикселей**: Возвращается исходное значение
- **Edge padding**: Корректная обработка краев изображения

## Использование

### Через интерфейс
1. Запустите приложение: `python run.py`
2. Загрузите изображение
3. Выберите нужный сигма-фильтр из выпадающего списка
4. Нажмите "Применить преобразование"

### Программно
```python
from image_processing.factories.transform_factory import TransformFactory

# Создание фильтра
sigma_filter = TransformFactory.create_transform("Сигма-фильтр σ=2.0")

# Применение к изображению
import numpy as np
image_array = np.array(your_image)
filtered_image = sigma_filter.apply(image_array)
```

### Создание фильтра с произвольным σ
```python
from image_processing.transforms.smoothing_filters import SigmaFilter

# Создание фильтра с σ=1.5
sigma_filter = SigmaFilter(sigma=1.5, kernel_size=5)
filtered_image = sigma_filter.apply(image_array)
```

## Сравнение фильтров

| σ | Характеристика | Удаление выбросов | Применение |
|---|----------------|-------------------|------------|
| 1.0 | Строгое | > 1σ | Сильный шум, мелкие выбросы |
| 2.0 | Умеренное | > 2σ | Средний шум, общая очистка |
| 3.0 | Мягкое | > 3σ | Слабый шум, сохранение деталей |

## Тестирование

Все фильтры протестированы на:
- ✅ Серых изображениях
- ✅ Цветных изображениях  
- ✅ Изображениях с выбросами
- ✅ Алгоритме удаления выбросов
- ✅ Сравнении различных значений σ
- ✅ Интеграции с фабрикой преобразований

## Математические детали

### Статистические вычисления
```python
# Среднее значение в окне
mean_value = np.mean(window)

# Стандартное отклонение в окне
std_value = np.std(window)

# Порог отклонения
threshold = self.sigma * std_value
```

### Фильтрация пикселей
```python
# Отбор пикселей, близких к среднему
filtered_pixels = []
for pixel in window.flatten():
    if abs(pixel - mean_value) <= threshold:
        filtered_pixels.append(pixel)
```

### Обработка краев
Используется edge padding для корректной обработки краев изображения:
```python
padded_image = np.pad(image, pad_size, mode='edge')
```

## Преимущества сигма-фильтра

1. **Адаптивность**: Порог определяется локальной статистикой
2. **Сохранение деталей**: Удаляются только явные выбросы
3. **Гибкость**: Различные значения σ для разных типов шума
4. **Эффективность**: Быстрая обработка с минимальными артефактами

Сигма-фильтры обеспечивают эффективное удаление шума с сохранением важных деталей изображения.
