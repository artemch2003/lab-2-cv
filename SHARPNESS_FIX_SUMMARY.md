# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—à–∏–±–∫–∏ –≤ SharpnessComparator

## üêõ –ü—Ä–æ–±–ª–µ–º–∞

–û—à–∏–±–∫–∞: `the resolved dtypes are not compatible with add.reduce. Resolved (dtype('<U18'), dtype('<U18'), dtype('<U36'))`

**–ü—Ä–∏—á–∏–Ω–∞**: –í `QualityAssessment.compute_quality_metrics()` –º–µ—Ç–æ–¥ –≤–æ–∑–≤—Ä–∞—â–∞–ª `quality_rating` –∫–∞–∫ —Å—Ç—Ä–æ–∫—É ("–û—Ç–ª–∏—á–Ω–æ–µ", "–•–æ—Ä–æ—à–µ–µ", –∏ —Ç.–¥.), –∞ `SharpnessComparator` –ø—ã—Ç–∞–ª—Å—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ (`np.mean`, `min`, `max`) —Å–æ —Å—Ç—Ä–æ–∫–∞–º–∏.

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω `QualityAssessment.compute_quality_metrics()`

**–§–∞–π–ª**: `image_processing/quality_assessment.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –ë—ã–ª–æ:
metrics['quality_rating'] = "–û—Ç–ª–∏—á–Ω–æ–µ"  # –°—Ç—Ä–æ–∫–∞

# –°—Ç–∞–ª–æ:
metrics['quality_rating'] = 90.0  # –ß–∏—Å–ª–æ –¥–ª—è –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
metrics['quality_label'] = "–û—Ç–ª–∏—á–Ω–æ–µ"  # –°—Ç—Ä–æ–∫–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
```

**–®–∫–∞–ª–∞ –æ—Ü–µ–Ω–æ–∫**:
- –û—Ç–ª–∏—á–Ω–æ–µ: 90.0
- –•–æ—Ä–æ—à–µ–µ: 75.0  
- –£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ: 60.0
- –ü–ª–æ—Ö–æ–µ: 30.0

### 2. –û–±–Ω–æ–≤–ª–µ–Ω `SharpnessComparator._create_comparison_summary()`

**–§–∞–π–ª**: `image_processing/sharpness_comparator.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –ë—ã–ª–æ:
'average_quality': np.mean([m['quality_rating'] for m in results['quality_metrics'].values()])

# –°—Ç–∞–ª–æ:
quality_ratings = [float(m['quality_rating']) for m in results['quality_metrics'].values()]
'average_quality': np.mean(quality_ratings) if quality_ratings else 0.0
```

### 3. –û–±–Ω–æ–≤–ª–µ–Ω `SharpnessComparator._find_best_filters()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –ë—ã–ª–æ:
key=lambda x: x[1]['quality_rating']

# –°—Ç–∞–ª–æ:
key=lambda x: float(x[1]['quality_rating'])
```

### 4. –û–±–Ω–æ–≤–ª–µ–Ω `QualityAssessment.format_quality_report()`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
```python
# –ë—ã–ª–æ:
f"–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: {metrics['quality_rating']}"

# –°—Ç–∞–ª–æ:
f"–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: {metrics.get('quality_label', metrics['quality_rating'])}"
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–æ–∑–¥–∞–Ω —Ç–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª `test_sharpness_fix.py` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –ó–∞–ø—É—Å–∫ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö –≤ –º–µ—Ç—Ä–∏–∫–∞—Ö
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–∞ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π

## üìã –†–µ–∑—É–ª—å—Ç–∞—Ç

‚úÖ **–û—à–∏–±–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞**
- `quality_rating` —Ç–µ–ø–µ—Ä—å —á–∏—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- `quality_label` –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
- –í—Å–µ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Å—Ä–∞–≤–Ω–µ–Ω–∏—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ —Ä–µ–∑–∫–æ—Å—Ç–∏ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ—à–∏–±–æ–∫:
- –í—ã–±–æ—Ä –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ k –∏ Œª
- –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–æ–≤
- –ê–Ω–∞–ª–∏–∑ –∫–∞—á–µ—Å—Ç–≤–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤
- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –≤—ã–±–æ—Ä—É

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!
